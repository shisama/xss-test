<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Security-Policy" content="trusted-types my-policy">
<title>innerHTML | XSS test</title>
</head>
<body>
<script>
  let errorMessage = null;
  try {
    TrustedTypes.createPolicy("my-policy", {
      createHTML: (unsafe) => {
        return unsafe
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;")
      }
    })
  } catch (e) {
    errorMessage = `Go to 'chrome://flags/#enable-experimental-web-platform-features' and enable it!`;
    alert(errorMessage)
  }
  const hash = decodeURIComponent(location.hash.slice(1));
  document.body.innerHTML = hash;
  document.body.innerText = errorMessage;
</script>
</body>
</html>